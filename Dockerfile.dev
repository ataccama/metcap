FROM blufor/lightimage
RUN apk --no-cache add \
  go \
  go-tools \
  gcc \
  musl-dev \
  graphviz \
  && mkdir -p /go /tmp /var/tmp /go/src/github.com/blufor/metcap
ENV GOPATH "/go/:/usr/lib/go"
ENV GOBIN "/usr/local/bin"
ENV PWD "/go"
RUN cd /go && go get \
  github.com/BurntSushi/toml \
  github.com/RackSec/srslog \
  github.com/streadway/amqp \
  github.com/pkg/profile \
  gopkg.in/olivere/elastic.v3 \
  gopkg.in/redis.v4 \
  gopkg.in/vmihailenco/msgpack.v2
VOLUME /go/src/github.com/blufor/metcap /usr/local/bin /go/pkg /tmp
CMD [ "/bin/bash", "-li" ]
